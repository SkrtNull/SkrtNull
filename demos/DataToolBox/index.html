<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="stylesheet" href="assets/css/styles.css"> </head>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
<body>
    <div id="vanta-canvas"></div>

    <main class="content">
        <h1>DataToolBox</h1>
        <div class="code-box">
            <code>pip install datatoolbox</code>
        </div>
        <div class="code-box">
        <button id="ejecutar">Ejecutar Demo</button>
        <div id="output" style="margin-top: 20px; color: #7ee787; font-family: monospace; white-space: pre-wrap;">
            </div>
        </div>

        <py-config>
            [[fetch]]
            files = ["pipeline.py", "kit.py"]
        </py-config>

        <script type="py">
          from pyscript import document
          from pyodide.ffi import create_proxy
          import sys

          # Redirigir errores de consola al div de la pantalla
          class WebLogger:
              def write(self, text):
                  if text.strip():
                      document.querySelector("#output").innerHTML += f"<div>{text}</div>"
              def flush(self): pass

          sys.stdout = sys.stderr = WebLogger()

          async def run_pipeline(event):
              out = document.querySelector("#output")
              out.innerHTML = "<b style='color: #ff3f81'>[SYSTEM]</b> Ejecutando pipeline real...<br>"
              
              try:
                  # Intentamos importar y ejecutar
                  import pipeline
                  # Si tu función en pipeline.py se llama main()
                  resultado = pipeline.main() 
                  out.innerHTML += f"<br><b style='color: #7ee787'>[SUCCESS]</b> Result: {resultado}"
              except ModuleNotFoundError as e:
                  out.innerHTML += f"<br><b style='color: red'>[ERROR]</b> No encontré el archivo: {e.name}. <br>Verifica que pipeline.py esté junto al index.html"
              except Exception as e:
                  out.innerHTML += f"<br><b style='color: red'>[PYTHON ERROR]</b> {str(e)}"

          # Conectar el botón
          try:
              btn = document.querySelector("#ejecutar")
              btn.addEventListener("click", create_proxy(run_pipeline))
              document.querySelector("#output").innerHTML = "✅ Motor de Python listo."
          except:
            pass
        </script>

        </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
    <script>
        VANTA.NET({
          el: "#vanta-canvas",
          mouseControls: true,
          touchControls: true,
          gyroControls: false,
          minHeight: 200.00,
          minWidth: 200.00,
          scale: 1.00,
          scaleMobile: 1.00,
          color: 0x551a30,           /* Un rosa mucho más oscuro para las líneas */
          backgroundColor: 0x0c1117, 
          points: 25.00,             /* Aumentamos los puntos */
          maxDistance: 20.00,        /* Líneas más cortas para que no saturen */
          spacing: 15.00,
          showDots: true             /* Los puntos seguirán siendo visibles */
        })
    </script>
</body>
</html>